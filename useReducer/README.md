# useReducer

- [ ] `useReducer()` - —ç—Ç–æ —Ö—É–∫, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç `reducer` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–∞–∫ `useState`, –Ω–æ –±–æ–ª–µ–µ –≥–∏–±–∫–æ.

  + `Reducer` - —ç—Ç–æ —Ñ-—è, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∫–∞–∫ setState). –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º `state` –∏ `action`. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —É—á–∏—Ç—ã–≤–∞—è `–∏–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å`

![image](https://github.com/acidshotgun/react-hooks-new/assets/117285472/269afcf8-5c41-488b-bebe-d5ccb61a0a4e)


<h2>–ü—Ä–∏–º–µ—Ä</h2>

- [ ] `useReducer` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

```typescript
  import { useReducer } from 'react';

  // reducer –ø—Ä–∏–Ω–∏–º–∞–µ—Ç state –∏ action
  function reducer(state, action) {
    // ... –ª–æ–≥–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ reducer
  }
  
  function MyComponent() {
    const [state, dispatch] = useReducer(reducer, { age: 42 });
    // ... –ª–æ–≥–∏–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
```

<br>

<h3>+ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>

- [x] `reducer` - —ç—Ç–æ —Ñ-—è, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∫–∞–∫ `setState`). –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º `state - —ç—Ç–æ –Ω—ã–Ω–µ—à–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç reducer` –∏ `action - —Å–æ–±—ã—Ç–∏–µ`. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —É—á–∏—Ç—ã–≤–∞—è `–∏–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å`

- [x] `initialArg` - –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –õ–∏–±–æ —Å–∞–º–æ –∑–Ω-–µ –ª–∏–±–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å –Ω–∏–º (–∫–∞–∫ –≤ –∫–∞–π—Ñ).
- [x] –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û `init:` - –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ï—Å–ª–∏ –æ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ `initialArg`. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ `init(initialArg)`.

<br>

<h3>+ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç</h3>

- [x] –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - –Ω–∞ –æ—Å–Ω–æ–≤–µ `initialArg` (–∏–ª–∏ `init`)
- [x] `dispatch function` - –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ –¥—Ä—É–≥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤—ã–∑–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥.

<hr>
<br>
<br>

<h2>dispatch function </h2>

- [x] `dispatch` - —ç—Ç–æ —Ñ-—è, –æ–±–Ω–æ–≤–ª—è—é—â–∞—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –≤—ã–∑—ã–≤–∞—é—â–∞—è –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä. –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–º –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ `action`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π `case` –≤ `reducer` –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è.
- [x]  –ü–æ —Ç—Ä–∞–¥–∏—Ü–∏–∏, –¥–µ–π—Å—Ç–≤–∏–µ –æ–±—ã—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–±—ä–µ–∫—Ç —Å–æ —Å–≤–æ–π—Å—Ç–≤–æ–º `type` (–∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—â–∏–º —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ), –∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥—Ä—É–≥–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π (–¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–µ–π—Ç–∞).

```javascript
  const [state, dispatch] = useReducer(reducer, initialState);

  function handleInputChange(e) {
    // –≤—ã–∑–æ–≤ dispatch –≤ –∫–∞–∫–∏–º-—Ç–æ action –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º, –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è —Å—Ç–µ–π—Ç
    dispatch({
      type: 'changed_name',
      nextName: e.target.value
    }); 
  }
```

<hr>
<br>
<br>

<h2>–ü–†–ò–ú–ò–ß–ê–ù–ò–ï </h2>

- [ ] –ï—Å–ª–∏ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ, –∏–¥–µ–Ω—Ç–∏—á–Ω–æ —Ç–µ–∫—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é, —á—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º `Object.is`, React –ø—Ä–æ–ø—É—Å—Ç–∏—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –≠—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è.

<hr>
<br>
<br>

<h2>–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã </h2>

[–ë–ê–ó–û–í–´–ô –ü–†–ò–ú–ï–† –†–ê–ë–û–¢–´](https://codesandbox.io/p/sandbox/react-dev-forked-s9rrhz?file=%2Fsrc%2FApp.js%3A10%2C9)

- [x] –ö–∞–≤–æ:

  + –°–æ–∑–¥–∞–µ—Ç—Å—è `reducer`, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π `action`.
  + –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ —Å–µ–±—è `state` (—Å—Å—ã–ª–∞–µ—Ç –Ω–∞ –Ω—ã–Ω–µ—à–Ω–µ–µ) –∏ —Å–∞–º `action` (`action.type` - —ç—Ç–æ —Å–∞–º —ç–∫—à–Ω)
  + –ó–∞—Ç–µ–º `actions` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ –∫–µ–π—Å–∞—Ö.
     
  ```javascript
    function reducer(state, action) {
      switch (action.type) {
        case "incremented_age": {
          return {
            name: state.name,
            age: state.age + 1,
          };
        }
        case "changed_name": {
          return {
            name: action.nextName,
            age: state.age,
          };
        }
      }
      throw Error("Unknown action: " + action.type);
    }
  ```

  <br>

  + –°–æ–∑–¥–∞–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ö—É–∫–∞ `useReducer` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (—Å–∞–º —Ä–µ–¥—é—Å–µ—Ä –∏ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ) (–∫–∞–∫ useState)
  + –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—Ç–µ–π—Ç –∏ `dispatch`
  + –°–º–µ–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—ã–∑–≤–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –≤—ã–∑–æ–≤–∞ `dispatch` —Å –æ–±—ä–µ–∫—Ç–æ–º, –≥–¥–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã–π `type`, –∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ - –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–µ —Å–≤-–≤–æ.

  ```javascript
    export default function Form() {
      const [state, dispatch] = useReducer(reducer, { name: "Taylor", age: 42 });
    
      function handleButtonClick() {
        dispatch({ type: "incremented_age" });
      }
    
      function handleInputChange(e) {
        dispatch({
          type: "changed_name",
          nextName: e.target.value,
        });
      }
    
      return (
        <>
          <input value={state.name} onChange={handleInputChange} />
          <button onClick={handleButtonClick}>Increment age</button>
          <p>
            Hello, {state.name}. You are {state.age}.
          </p>
        </>
      );
    }
  ```

<br>
<br>

[–ï–©–ï –û–î–ò–ù –ü–†–ò–ú–ï–† –ü–û–ë–û–õ–¨–®–ï](https://codesandbox.io/p/sandbox/usereducer-big-example-mzdkjq?file=%2Fsrc%2FApp.js)

<hr>
<br>
<br>

<h2>–û–®–ò–ë–ö–ò</h2>

<h3>+ –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª –¥–µ–π—Å—Ç–≤–∏–µ, –Ω–æ —ç–∫—Ä–∞–Ω –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è</h3>

  - [x] React –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–≤–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É, —á—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º `Object.is`.
  - [x] –û–±—ã—á–Ω–æ –æ—à–∏–±–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –≤—ã –∏–∑–º–µ–Ω—è–µ—Ç–µ –æ–±—ä–µ–∫—Ç –∏–ª–∏ –º–∞—Å—Å–∏–≤ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –Ω–∞–ø—Ä—è–º—É—é:

  ```javascript
    function reducer(state, action) {
      switch (action.type) {
        case 'incremented_age': {
          // üö© Wrong: mutating existing object
          state.age++;
          return state;
        }
        case 'changed_name': {
          // üö© Wrong: mutating existing object
          state.name = action.nextName;
          return state;
        }
        // ...
      }
    }
  ```

  - [x] –í—ã `–º—É—Ç–∏—Ä–æ–≤–∞–ª–∏` —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –æ–±—ä–µ–∫—Ç `state` –∏ –≤–µ—Ä–Ω—É–ª–∏ –µ–≥–æ, –ø–æ—ç—Ç–æ–º—É React –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.
  - [x] –ß—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ, –≤–∞–º –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—ã –≤—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ –æ–±—ä–µ–∫—Ç—ã –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ –º–∞—Å—Å–∏–≤—ã –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –∞ –Ω–µ –º—É—Ç–∏—Ä—É–µ—Ç–µ –∏—Ö:

  ```javascript
    function reducer(state, action) {
      switch (action.type) {
        case 'incremented_age': {
          // ‚úÖ Correct: creating a new object
          return {
            ...state,
            age: state.age + 1
          };
        }
        case 'changed_name': {
          // ‚úÖ Correct: creating a new object
          return {
            ...state,
            name: action.nextName
          };
        }
        // ...
      }
    }
  ```

<br>
<br>

<h3>+ –ß–∞—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–µ–≥–æ redues —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è undefined –ø–æ—Å–ª–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏–∏</h3>

- [x] –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–∂–¥–∞—è –≤–µ—Ç–≤—å –¥–µ–ª–∞ –∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

```javascript
  function reducer(state, action) {
    switch (action.type) {
      case 'incremented_age': {
        return {
          ...state, // Don't forget this!!!!!!!!!!!
          age: state.age + 1
        };
      }
```

<br>
<br>

- [ ] –ö–û–†–û–ß–ï –í–°–ï–ì–î–ê –ù–£–ñ–ù–û –°–õ–ï–î–ò–¢–¨ –ó–ê –ò–ú–ú–£–¢–ê–ë–ï–õ–¨–ù–û–°–¢–¨–Æ
- [ ] –ï–°–õ–ò –°–¢–ï–ô–¢ - –≠–¢–û `–û–ë–™–ï–ö–¢` –ò–õ–ò `–ú–ê–°–°–ò–í`, –¢–û –ü–†–ò –ò–ó–ú–ï–ù–ï–ù–ò–ò–ò –û–î–ù–û–ì–û –°–í-–í–ê ==> –ö–û–ü–ò–†–£–ï–ú –û–°–¢–ê–õ–¨–ù–´–ï (`–ò–ú–ú–£–¢–ê–ë–ï–õ–¨–ù–û–°–¢–¨`)

<br>
<br>

<h3>+ –í—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–µ–≥–æ reducer —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è undefined –ø–æ—Å–ª–µ dispatch</h3>

- [x] –û—à–∏–±–∫–∞ –≤ `cases` –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `action`
